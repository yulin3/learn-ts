<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第三週 | TypeScript</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="TS學習筆記">
    <link rel="preload" href="/learn-ts/assets/css/0.styles.797325db.css" as="style"><link rel="preload" href="/learn-ts/assets/js/app.55c160e2.js" as="script"><link rel="preload" href="/learn-ts/assets/js/2.dfdd3c99.js" as="script"><link rel="preload" href="/learn-ts/assets/js/9.6ac36e92.js" as="script"><link rel="prefetch" href="/learn-ts/assets/js/10.15e80043.js"><link rel="prefetch" href="/learn-ts/assets/js/11.a90c4d07.js"><link rel="prefetch" href="/learn-ts/assets/js/12.89b4bda8.js"><link rel="prefetch" href="/learn-ts/assets/js/13.bedd056b.js"><link rel="prefetch" href="/learn-ts/assets/js/14.13d729ed.js"><link rel="prefetch" href="/learn-ts/assets/js/3.a6309aba.js"><link rel="prefetch" href="/learn-ts/assets/js/4.ce76527a.js"><link rel="prefetch" href="/learn-ts/assets/js/5.8846d71d.js"><link rel="prefetch" href="/learn-ts/assets/js/6.82b12916.js"><link rel="prefetch" href="/learn-ts/assets/js/7.84ecf684.js"><link rel="prefetch" href="/learn-ts/assets/js/8.8006b224.js">
    <link rel="stylesheet" href="/learn-ts/assets/css/0.styles.797325db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-ts/" class="home-link router-link-active"><!----> <span class="site-name">TypeScript</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-ts/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/learn-ts/ts/" class="nav-link router-link-active">
  TS學習筆記
</a></div> <a href="https://github.com/yulin3/learn-ts" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-ts/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/learn-ts/ts/" class="nav-link router-link-active">
  TS學習筆記
</a></div> <a href="https://github.com/yulin3/learn-ts" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>TS學習筆記</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-ts/ts/" class="sidebar-link">總綱</a></li><li><a href="/learn-ts/ts/base.html" class="sidebar-link">第一週</a></li><li><a href="/learn-ts/ts/week2.html" class="sidebar-link">第二週</a></li><li><a href="/learn-ts/ts/week3.html" class="active sidebar-link">第三週</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-ts/ts/week3.html#函数類型" class="sidebar-link">函数類型</a></li><li class="sidebar-sub-header"><a href="/learn-ts/ts/week3.html#类型断言" class="sidebar-link">类型断言</a></li><li class="sidebar-sub-header"><a href="/learn-ts/ts/week3.html#參考" class="sidebar-link">參考</a></li></ul></li><li><a href="/learn-ts/ts/week4.html" class="sidebar-link">第四週</a></li><li><a href="/learn-ts/ts/week7.html" class="sidebar-link">第七週</a></li><li><a href="/learn-ts/ts/week8.html" class="sidebar-link">第八週</a></li><li><a href="/learn-ts/ts/week9.html" class="sidebar-link">第九週</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第三週"><a href="#第三週" class="header-anchor">#</a> 第三週</h1> <p>忙碌是常態</p> <h2 id="函数類型"><a href="#函数類型" class="header-anchor">#</a> 函数類型</h2> <p><a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch2.html" title="​函数是 JavaScript 中的一等公民" target="_blank" rel="noopener noreferrer">​函数是 JavaScript 中的一等公民<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="函数声明"><a href="#函数声明" class="header-anchor">#</a> 函数声明</h3> <p>在 JavaScript 中，有两种常见的定义函数的方式——函数声明和函数表达式</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 1.函数声明（Function Declaration）</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
​
<span class="token comment">// 2.函数表达式（Function Expression）</span>
<span class="token keyword">let</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>一个函数有输入和输出，要在 TypeScript 中对其进行约束，需要把输入和输出都考虑到</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// 输入多余的（或者少于要求的）参数，是不被允许的</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token string">'abby'</span><span class="token punctuation">,</span> <span class="token string">'kitty'</span><span class="token punctuation">)</span>
<span class="token comment">// index.ts(4,1): error TS2346: Supplied parameters do not match any signature of call target</span>

<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// index.ts(4,1): error TS2346: Supplied parameters do not match any signature of call target</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="函数表达式"><a href="#函数表达式" class="header-anchor">#</a> 函数表达式</h3> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
<span class="token comment">// 这是可以通过编译的，不过事实上，上面的代码只对等号右侧的匿名函数进行了类型定义，而等号左边的 getName，是通过赋值操作进行类型推论而推断出来的</span>

<span class="token comment">// 手动给 getName 添加类型</span>
<span class="token keyword">let</span> <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>注意不要混淆了 TypeScript 中的 =&gt; 和 ES6 中的 =&gt;
在 TypeScript 的类型定义中，=&gt; 用来表示函数的定义，左边是输入类型，需要用括号括起来，右边是输出类型</p></div> <h3 id="用接口定义函数的形状"><a href="#用接口定义函数的形状" class="header-anchor">#</a> 用接口定义函数的形状</h3> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 采用函数表达式|接口定义函数的方式时，对等号左侧进行类型限制，可以保证以后对函数名赋值时保证参数个数、参数类型、返回值类型不变</span>
<span class="token keyword">interface</span> <span class="token class-name">isString</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>source<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> boolean
<span class="token punctuation">}</span>
​
<span class="token keyword">let</span> getType<span class="token operator">:</span> isString
<span class="token function-variable function">getType</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'string'</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="可选参数"><a href="#可选参数" class="header-anchor">#</a> 可选参数</h3> <p>与接口中的可选属性类似，我们用 ? 表示可选的参数</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 可选参数必须接在必需参数后面</span>
<span class="token keyword">function</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string<span class="token punctuation">,</span> sex<span class="token operator">?</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> abby <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">'Abby'</span><span class="token punctuation">,</span> <span class="token string">'girl'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> didi <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">'Didi'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="参数默认值"><a href="#参数默认值" class="header-anchor">#</a> 参数默认值</h3> <p>TypeScript 会将添加了默认值的参数识别为可选参数</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 此时就不受「可选参数必须接在必需参数后面」的限制了</span>
<span class="token keyword">function</span> <span class="token function">person</span><span class="token punctuation">(</span>sex<span class="token operator">?</span><span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">'boy'</span> name<span class="token operator">:</span> string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>person<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sex<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> abby <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">'Abby'</span><span class="token punctuation">,</span> <span class="token string">'girl'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> didi <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token string">'Didi'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="剩余参数"><a href="#剩余参数" class="header-anchor">#</a> 剩余参数</h3> <p>ES6 中，可以使用 ...rest 的方式获取函数中的剩余参数，该参数只能是最后一个参数</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// items 是一个数组，所以可以用数组的类型来定义它</span>
<span class="token keyword">function</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">array<span class="token punctuation">,</span> <span class="token operator">...</span>items<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">let</span> luckyNum<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token function">push</span><span class="token punctuation">(</span>luckyNum<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="重载"><a href="#重载" class="header-anchor">#</a> 重载</h3> <p>重载定义多个 reverse 的函数类型</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 重复定义了多次函数 reverse，前几次都是函数定义，最后一次是函数实现</span>
<span class="token keyword">function</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number
<span class="token keyword">function</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> string
<span class="token keyword">function</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> number <span class="token operator">|</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token operator">|</span> string <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <p>注意，TypeScript 会优先从最前面的函数定义开始匹配，所以多个函数定义如果有包含关系，需要优先把精确的定义写在前面</p></div> <h2 id="类型断言"><a href="#类型断言" class="header-anchor">#</a> 类型断言</h2> <p>类型断言可以用来手动指定一个值的类型，语法: 值 as 类型 或 &lt;类型&gt;值</p> <h3 id="将一个联合类型断言为其中一个类型"><a href="#将一个联合类型断言为其中一个类型" class="header-anchor">#</a> 将一个联合类型断言为其中一个类型</h3> <p>当 TypeScript 不确定一个联合类型的变量到底是哪个类型的时候，我们只能访问此联合类型的所有类型中共有的属性或方法</p> <p>而有时候，我们确实需要在还不确定类型的时候就访问其中一个类型特有的属性或方法</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Aircraft</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
​
<span class="token comment">// Property 'fly' does not exist on type 'Ferrari'</span>
<span class="token keyword">function</span> <span class="token function">isFerrari</span><span class="token punctuation">(</span><span class="token parameter">vehicle<span class="token operator">:</span> Ferrari <span class="token operator">|</span> Aircraft</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vehicle<span class="token punctuation">.</span>run <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token comment">//获取 Aircraft.fly 的时候会报错，此时可以将 vehicle 断言成 Ferrari</span>
<span class="token keyword">function</span> <span class="token function">isFerrari</span><span class="token punctuation">(</span><span class="token parameter">vehicle<span class="token operator">:</span> Ferrari <span class="token operator">|</span> Aircraft</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>vehiclea <span class="token keyword">as</span> Ferrari<span class="token punctuation">)</span><span class="token punctuation">.</span>run <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>需要注意的是，类型断言只能够「欺骗」TypeScript 编译器，无法避免运行时的错误，反而滥用类型断言可能会导致运行时错误
使用类型断言时一定要格外小心，尽量避免断言后调用方法或引用深层属性，以减少不必要的运行时错误</p> <h3 id="将一个父类断言为更加具体的子类"><a href="#将一个父类断言为更加具体的子类" class="header-anchor">#</a> 将一个父类断言为更加具体的子类</h3> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">ApiError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
    code<span class="token operator">:</span> number
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">HttpError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
    statusCode<span class="token operator">:</span> number
<span class="token punctuation">}</span>
​
<span class="token keyword">function</span> <span class="token function">isApiError</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token operator">:</span> Error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父类 Error 中没有 code 属性，故直接获取 error.code 会报错，需要使用类型断言获取 (error as ApiError).code</span>
    <span class="token comment">// 接口是一个类型，不是一个真正的值，它在编译结果中会被删除，无法使用 instanceof 来做运行时判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>error <span class="token keyword">as</span> ApiError<span class="token punctuation">)</span><span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="将任何一个类型断言为-any"><a href="#将任何一个类型断言为-any" class="header-anchor">#</a> 将任何一个类型断言为 any</h3> <p>需要注意的是，将一个变量断言为 any 可以说是解决 TypeScript 中类型问题的最后一个手段
它极有可能掩盖了真正的类型错误，所以如果不是非常确定，就不要使用 as any</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token number">1</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="将-any-断言为一个具体的类型"><a href="#将-any-断言为一个具体的类型" class="header-anchor">#</a> 将 any 断言为一个具体的类型</h3> <p>遇到 any 类型的变量时，通过类型断言及时的把 any 断言为精确的类型，使我们的代码向着高可维护性的目标发展</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getCacheData</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token comment">// 我们调用完 getCacheData 之后，立即将它断言为明确的 Ferrari 类型​</span>
<span class="token keyword">const</span> LaFerrari <span class="token operator">=</span> <span class="token function">getCacheData</span><span class="token punctuation">(</span><span class="token string">'LaFerrari'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Ferrari
LaFerrari<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="类型断言的限制"><a href="#类型断言的限制" class="header-anchor">#</a> 类型断言的限制</h3> <p>并不是任何一个类型都可以被断言为任何另一个类型，若 A 兼容 B，那么 A 能够被断言为 B，B 也能被断言为 A</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">Vehiclea</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">function</span> <span class="token function">testVehiclea</span><span class="token punctuation">(</span><span class="token parameter">vehiclea<span class="token operator">:</span> Vehiclea</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>vehiclea <span class="token keyword">as</span> Ferrari<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">testFerrari</span><span class="token punctuation">(</span><span class="token parameter">ferrari<span class="token operator">:</span> Ferrari</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>ferrari <span class="token keyword">as</span> Vehiclea<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>允许 vehiclea as Ferrari 是因为「父类可以被断言为子类」
允许 ferrari as Vehiclea 是因为既然子类拥有父类的属性和方法，那么被断言为父类，获取父类的属性、调用父类的方法，就不会有任何问题，故「子类可以被断言为父类」</p> <h3 id="双重断言"><a href="#双重断言" class="header-anchor">#</a> 双重断言</h3> <p>双重断言，则可以打破「要使得 A 能够被断言为 B，只需要 A 兼容 B 或 B 兼容 A 即可」的限制，将任何一个类型断言为任何另一个类型
若你使用了这种双重断言，那么十有八九是非常错误的，它很可能会导致运行时错误</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Aircraft</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">function</span> <span class="token function">testAircraft</span><span class="token punctuation">(</span><span class="token parameter">LaFerrari<span class="token operator">:</span> Ferrari</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 除非迫不得已，千万别用双重断言</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>LaFerrari <span class="token keyword">as</span> any <span class="token keyword">as</span> Aircraft<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="类型断言-vs-类型转换"><a href="#类型断言-vs-类型转换" class="header-anchor">#</a> 类型断言 vs 类型转换</h3> <p>类型断言只会影响 TypeScript 编译时的类型，类型断言语句在编译结果中会被删除</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">toBoolean</span><span class="token punctuation">(</span><span class="token parameter">something<span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">{</span>
    <span class="token keyword">return</span> something <span class="token keyword">as</span> boolean
<span class="token punctuation">}</span>
​
<span class="token function">toBoolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// 返回值为 1</span>

<span class="token comment">// something 断言为 boolean 虽然可以通过编译，但是并没有什么用，代码在编译后会变成 </span>
<span class="token keyword">function</span> <span class="token function">toBoolean</span><span class="token punctuation">(</span><span class="token parameter">something</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> something
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>所以类型断言不是类型转换，它不会真的影响到变量的类型</p> <h3 id="类型断言-vs-类型声明"><a href="#类型断言-vs-类型声明" class="header-anchor">#</a> 类型断言 vs 类型声明</h3> <p>类型声明比类型断言更加严格 最好优先使用类型声明</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getCacheData</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">const</span> LaFerrari <span class="token operator">=</span> <span class="token function">getCacheData</span><span class="token punctuation">(</span><span class="token string">'LaFerrari'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Ferrari
LaFerrari<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 类型声明</span>
<span class="token keyword">const</span> LaFerrari<span class="token operator">:</span> Ferrari <span class="token operator">=</span> <span class="token function">getCacheData</span><span class="token punctuation">(</span><span class="token string">'LaFerrari'</span><span class="token punctuation">)</span>
LaFerrari<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="类型断言-vs-泛型"><a href="#类型断言-vs-泛型" class="header-anchor">#</a> 类型断言 vs 泛型</h3> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> getCacheData<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>key<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">interface</span> <span class="token class-name">Ferrari</span> <span class="token punctuation">{</span>
    model<span class="token operator">:</span> string
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">const</span> LaFerrari <span class="token operator">=</span> getCacheData<span class="token operator">&lt;</span>Ferrari<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'LaFerrari'</span><span class="token punctuation">)</span>
LaFerrari<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通过给 getCacheData 函数添加了一个范型 <T>，我们可以更加规范的实现对 getCacheData 返回值的约束，这也同时去除掉了代码中的 any，是最优的一个解决方案</T></p> <h2 id="參考"><a href="#參考" class="header-anchor">#</a> 參考</h2> <p><a href="https://ts.xcatliu.com/basics/type-of-function" title="TypeScript 入門教程" target="_blank" rel="noopener noreferrer">TypeScript 入門教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-ts/ts/week2.html" class="prev">
        第二週
      </a></span> <span class="next"><a href="/learn-ts/ts/week4.html">
        第四週
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/learn-ts/assets/js/app.55c160e2.js" defer></script><script src="/learn-ts/assets/js/2.dfdd3c99.js" defer></script><script src="/learn-ts/assets/js/9.6ac36e92.js" defer></script>
  </body>
</html>
